\chapter{Dynamics of First-Order Difference Equations}
\section{Introduction}
\begin{itemize}
    \item Starting from $x_0$, we have first iterate $f(x_0)$ whereas second iterate $f(f(x_0))=f^2(x_0)$. \\
        Generally $f^{n+1}(x_0)=f(f^{n}(x_0))$, particularly $f^0(x_0)=x_0$.
    \item The set of all (positive) iterates $\{f^n(x_0):n\geq 0\}=O(x_0)$, called (positive) orbit of $x_0$.
    \item $\text{Autonomous, time-invariant system }x(n+1)=f(x(n)).$
    \item Nonautonomous, time-variant system $x(n+1)=g(n,x(n)),\quad g: \mathbb{Z}^+ \times\mathbb{R}\to\mathbb{R}$. \\
        If an initial condition $x(n_0)=x_0$ is given, then for $n\geq n_0$, there is a \textit{unique solution} $x(n)\equiv x(n,n_0,x_0)$ of nonautonomous $x(n+1)=g(n,x(n))$
        \begin{explanation}
            This may be shown easily by iteration:
            \[
            \begin{array}{l}
                x(n_0+1)=g(n_0,x(n_0))=g(n_0,x_0) \\
                x(n_0+2)=g(n_0+1,x(n_0+1))=g(n_0+1,g(n_0,x_0)) \\
                x(n_0+3)=g(n_0+2,x(n_0+2))=g[n_0+2,g(n_0+1,g(n_0,x_0))]
            \end{array}
        \]
        Inductively, we get $x(n)=g[n-1,x(n-1)]=x(n,n_0,x_0)$ because there is unknown $x_0$, $n_0$ in $x(n-1)$.
        \end{explanation}
\end{itemize}

\section{Linear First-Order Difference Equations}
\begin{itemize}
    \item Typical linear \textit{homogeneous} first-order equation:
        \begin{align*} & x(n+1)=a(n)x(n) & \left(x(n_0)=x_0, n\geq n_0\geq 0\right), \end{align*}
        and the associated \textit{nonhomogeneous} equation:
        \begin{align*} & y(n+1)=a(n)y(n)+g(n) & \left(y(n_0)=y_0, n\geq n_0\geq 0\right), \end{align*}
        where in both equations it is assumed that $a(n)\neq 0$, and $a(n)$ and g(n are real-valued functions defined for $n\geq n_0\geq 0$.
    \item The solution of $x(n+1)=a(n)x(n)$:
        \[x(n)=x_0\left[\prod_{i=n_0}^{n-1} a(i)\right]\]
        \begin{explanation}
            May be obtained by a simple iteration:
            \[
            \begin{array}{l}
                x(n_0+1)=a(n_0)x(n_0)=a(n_0)x_0 \\
                x(n_0+2)=a(n_0+1)x(n_0+1)=a(n_0+1)a(n_0)x_0 \\
                x(n_0+3)=a(n_0+2)x(n_0+2)=a(n_0+2)a(n_0+1)a(n_0)x_0
            \end{array},
        \]
        inductively it is easy to see that $x(n)=a(n-1)a(n-2)\cdots a(n_0)x_0$
        \end{explanation}
        The unique solution of $y(n+1)=a(n)y(n)+g(n)$:
        \[y(n)=y_0\left[\prod_{i=n_0}^{n-1} a(i)\right]+\sum_{r=n_0}^{n-1}\left[\prod_{i=r+1}^{n-1} a(i)\right]g(r)\]
        \begin{explanation}
            This may be found by iteration and proof by mathematical induction. Also notice that $\prod_{i=n}^{n-1} a(i)=1$.
            \begin{align*}
                y(n_0+1) & =a(n_0)y_0+g(n_0) \\
                y(n_0+2) & =a(n_0+1)y(n_0+1)+g(n_0+1) \\
                         & =a(n_0+1)a(n_0)y_0+a(n_0+1)g(n_0)+g(n_0+1) \\
                y(n_0+3) & =a(n_0+2)y(n_0+2)+g(n_0+2) \\
                         & =a(n_0+2)a(n_0+1)a(n_0)y_0+a(n_0+2)a(n_0+1)g(n_0) \\
                         & \quad +a(n_0+2)g(n_0+1)+g(n_0+2)
            \end{align*}
            Inductively we can see the unique solution. To establish this, assume this formula holds for $n=k$, lets substitute into its original nonhomogeneous equation:
                \begin{align*}
                    y(k+1) & =a(k)y_0\left[\prod_{i=n_0}^{k-1} a(i)\right]+\sum_{r=n_0}^{k-1}\left[a(k)\prod_{i=r+1}^{k-1} a(i)\right]g(r)+g(k) \\
                           & =y_0\left[\prod_{i=n_0}^k a(i)\right]+\sum_{r=n_0}^{k-1}\left[\prod_{i=r+1}^k a(i)\right]g(r)+\left[\prod_{i=k+1}^k a(i)\right]g(k) \\
                           & =y_0\left[\prod_{i=n_0}^k a(i)\right]+\sum_{r=n_0}^k\left[\prod_{i=r+1}^k a(i)\right]g(r)
                \end{align*}
            Hench the unique solution holds for all $n\in\mathbb{Z}^+$
        \end{explanation}
\end{itemize}

\subsection{Important Special Cases}
\begin{enumerate}
    \item There are two special cases of $y(n+1)=a(n)y(n)+g(n)$, one of them is
        \begin{align*} & y(n+1)=ay(n)+g(n) & \left(y(0)=y_0\right) \end{align*}
        Using the solution formula may establish that
        \[y(n)=y_0a^n+\sum_{k=0}^{n-1} a^{n-k-1}g(k)\]
    \item The another one is
        \begin{align*} & y(n+1)=ay(n)+b & \left(y(0)=y_0\right) \end{align*}
        Using the unique solution we obtain
        \[
            y= \begin{cases}
                y_0a^n +b\frac{a^n-1}{a-1} & \text{if }a\neq 1, \\
                y_0+bn                    & \text{if }a=1.
            \end{cases}
        \]
        Notice here we use the sum formula of the Geometric Series $S_n=\frac{a_1(1-q^n)}{1-q}$ in the form $\sum_{k=0}^{n-1} a^{n-k-1}=a^{n-1}+\cdots+a^0\quad\left(a_1=a^0=1, q=a\right)$.
    \item The solution of the nonhomogeneous differential equation $\frac{\mathrm{d}y}{\mathrm{d}t}=ay(t)+g(t)\quad\left(y(0)=y_0)\right)$ is given by $y(t)=e^{at}y_0+\int_0^t e^{a(t-s)}g(s)\mathrm{d}s$.
        \begin{explanation}
            The solution uses the complete solution of first-order nonhomogeneous differential equation, which is hard to explain in a calculus courses. However, we can prove it in a forward way by taking derivatives of the solution:
            \begin{align*}
                y^\prime(t)=\frac{\mathrm{d}y}{\mathrm{d}t} & =ae^{at}y_0+\left[e^{at}\int_0^t e^{-as}g(s)\mathrm{d}s\right]^\prime \\
                & =ae^{at}y_0+(e^{at})^\prime\int_0^t e^{-as}g(s)\mathrm{d}s+e^{at}\left[\int_0^t e^{-as}g(s)\mathrm{d}s\right]^\prime \\
                & =ae^{at}y_0+ae^{at}\int_0^t e^{-as}g(s)\mathrm{d}s+e^{at}\underbrace{\left[\int_0^t e^{-as}g(s)\mathrm{d}s\right]^\prime}_{\begin{subarray}{l}
                        \because F^\prime(x)=f(x)=e^{-ax}g(x) \\
                        \therefore =[F(t)-F(0)]^\prime \\
                        \enspace=F^\prime(t)-F^\prime(0) \\
                        \enspace=e^{-at}g(t)
                \end{subarray}} \\
                & =ae^{at}y_0+ae^{at}\int_0^t e^{-as}g(s)\mathrm{d}s+e^{at}[e^{-at}g(t)] \\
                & =ae^{at}y_0+ae^{at}\int_0^t e^{-as}g(s)\mathrm{d}s+g(t) \\
                & =a\left[e^{at}y_0+\int_0^t e^{a(t-s)}g(s)\mathrm{d}s\right]+g(t) \\
                & =ay(t)+g(t)
            \end{align*}
        \end{explanation}
\end{enumerate}

\textbf{Examples}

\begin{enumerate}
    \item Solve the equation
        \begin{align*} & y(n+1)=(n+1)y(n)+2^n(n+1)! & \left(y(0)=1,n\ge 0\right) \end{align*}
        \begin{remark}
			\begin{tabular}{ccc}
			\multicolumn{3}{c}{Definite sum.} \\ \hline
			Number & Summation & Definite sum \\ \hline
            1      & $\sum_{k=1}^n k$ & $\frac{n(n+1)}{2}$ \\
            2      & $\sum_{k=1}^n k^2$    & $\frac{n(n+1)(2n+1)}{6}$ \\
            3      & $\sum_{k=1}^n k^3$    & $\left[\frac{n(n+1)}{2}\right]^2$ \\
            4      & $\sum_{k=1}^n k^4$    & $\frac{n(6n^4+15n^3+10n^2-1)}{30}$ \\
            5      & $\sum_{k=0}^{n-1} a^k$ & $\begin{cases}
                                            (a^n-1)/(a-1) & \text{if }a\neq 1 \\
                                            n & \text{if }a=1
                                          \end{cases}$ \\
            6      & $\sum_{k=1}^{n-1} a^k$ & $\begin{cases}
                                            (a^n-a)/(a-1) & \text{if }a\neq 1 \\
                                            n-1 & \text{if }a=1
                                          \end{cases}$ \\
            7      & $\sum_{k=1}^n ka^k\quad\left(a\neq 1\right) $ & $\frac{(a-1)(n+1)a^{n+1}-a^{n+2}+a}{(a-1)^2}$ \\ \hline
			\end{tabular}
        \end{remark}
        Solution
        \begin{align*}
            y(n) & =\prod_{i=0}^{n-1} (i+1)+\sum_{k=0}^{n-1}\left[\prod_{i=k+1}^{n-1} (i+1)\right]2^k(k+1)! \\
                 & =n!+\sum_{k=0}^{n-1} n!2^k \\
                 & =2^nn!\quad\text{(see the table above)}
        \end{align*}
    \item Find a solution for the equation
        \begin{align*}
            x(n+1)=2x(n)+3^n & \left(x(1)=0.5\right).
        \end{align*}
        Solution\quad From the unique solution of nonhomogeneous equation and of special case 1, we have
        \begin{align*}
            x(n) & =2^{n-1}\cdot0.5+\sum_{k=1}^{n-1}2^{n-k-1}3^k \\
                 & =2^{n-2}+2^{n-1}\sum_{k=1}^{n-1}(\frac{3}{2})^k \\
                 & =2^{n-2}+2^{n-1}\left(\frac{(\frac{3}{2})^n-\frac{3}{2}}{\frac{3}{2}-1}\right) \\
                 & =2^{n-2}+2^{n-1}\frac{3}{2}\left(\frac{(\frac{3}{2})^{n-1}-1}{\frac{3}{2}-1}\right) \\
                 & =2^{n-2}\left(1+3\frac{(\frac{3}{2})^{n-1}-1}{\frac{3}{2}-1}\right) \\
                 & =2^{n-2}\left(\frac{\frac{3}{2}-1}{\frac{3}{2}-1}+\frac{3^n\cdot 2^{1-n}-3}{\frac{3}{2}-1}\right) \\
                 & =2^{n-2}\left(\frac{3^n\cdot 2^{1-n}-\frac{5}{2}}{\frac{3}{2}-1}\right) \\
                 & =\frac{\frac{3^n}{2}-2^{n-2}\frac{5}{2}}{\frac{3}{2}-1} \\
                 & =\frac{3^n-2^{n-2}\cdot 5}{2-1} \\
                 & = 3^n-5\cdot 2^{n-2}.
        \end{align*}
    \item A drug is administered once every four hours. Let $D(n)$ be the amount of the drug in the blood system at the $n$th interval. The body eliminates a certain fraction $p$ of the drug during each time interval. If the amount administered is $D_0$, find $D(n)$ and $\lim_{n\to\infty} D(n)$.

        Solution\quad We first must create an equation to solve. Since the amount of drug in the patient's system at time $(n+1)$ is equal to the amount at time $n$ minus the fraction $p$ that has been eliminated from the body, plus the new dosage $D_0$, we arrive at the following equation:
        \[D(n+1)=(1-p)D(n)+D_0.\]
        Using the solution of special case 2, arriving at
        \begin{align*}
            D(n) & =(1-p)^nD_0+D_0\frac{(1-p)^n-1}{-p} \\
                 & =\left[D_0-\frac{D_0}{p}\right](1-p)^n+\frac{D_0}{p}
        \end{align*}
        Hence,
        \[\lim\limits_{n\to\infty} D(n)=\frac{D_0}{p}.\]
    \item Amortization

        Amortization is the process by which a loan is repaid by a sequence of periodic payments, each of which is part payment of interest and part payment to reduce the outstanding principal.

        Let $p(n)$ represent the outstanding principal after the $n$th payment $g(n)$. Suppose that interest charges compound at the rate $r$ per payment period.

        The formulation of our model here is based on the fact that the outstanding principal $p(n+1)$ after the $(n+1)$st payment is equal to the outstanding principal $p(n)$ after the $n$th payment plus the interest $rp(n)$ incurred during the $(n+1)$st period minus the $n$th payment $g(n)$. Hence
        \begin{align*}
            p(n+1) & =p(n)+rp(n)-g(n) & \left(p(0)=p_0\right) \\
                   & =(1+r)p(n)-g(n) &
        \end{align*}
        where $p_0$ is the initial debt. By solution of special case 1 we have
        \[p(n)=(1+r)^np_0-\sum_{k=0}^{n-1} (1+r)^{n-k-1}g(k)\]
        In practice, the payment $g(n)$ is constant and, say, equal to $T$. from solution of special case 2 we have
        \[p(n)=(1+r)^np_0-[(1+r)^n-1](\frac{T}{r}).\]
        If we want to pay off the loan in exactly $n$ payments, we have $p(n)=0$, the monthly payment
        \[T=p_0\left[\frac{r}{1-(1+r)^{-n}}\right].\]
\end{enumerate}

\section{Equilibrium Points}
\begin{definition}
    A point $x^*$ in the domain of $f$ is said to be an \textit{equilibrium point} of $x(n+1)=f(x(n))$ if it is a fixed point of $f$, i.e. $f(x^*)=x^*$
\end{definition}

In other words, $x^*$ is a \textit{constant solution}, since if $x(0)=x^*$ is an initial point, then $x(1)=f(x^*)=x^*$, and $x(2)=f(x(1))=f(x^*)=x^*$, and so on.

Graphically, $x^*$ is the $x$-coordinate where $f$ intersects the diagonal line $x=y$. For example, there are three equilibrium points for the equation
\[x(n+1)=x^3(n)\]
where $f(x)=x^3$. To find these equilibrium points, we let $f(x^*)=x^*$, or $x^3=x$, and solve for $x$. Hence there are three equilibrium points, $-1$, $0$, $1$ (Figure 1.1).
\begin{figure}[H]
    \centering
    \incfig{equilibrium_points_1}
    \caption{Fixed points of $f(x)=x^3$.}
\end{figure}

Figure 1.2 illustrates another example, where $f(x)=x^2-x+1$ and the difference equation is given by
\[x(n+1)=x^2(n)-x(n)+1.\]
Letting $x^2-x+1=x$, we find that $1$ is the only equilibrium point.
\begin{figure}[H]
    \centering
    \incfig{equilibrium_points_2}
    \caption{Fixed points of $f(x)=x^2-x+1$.}
\end{figure}

\begin{definition}
    Let $x$ be a point in the domain of $f$. If there exists a positive integer $r$ and an equilibrium point $x^*$ of $x(n+1)=f(x(n))$ such that $f^r(x)=x^*$, $f^{r-1}(x)\neq x^*$, then $x$ is an \textit{eventually equilibrium (fixed) point}.
\end{definition}

\begin{eg}
    \item The Tent Map
        Consider the equation (Figure 1.3)
        \[x(n+1)=T(x(n))\]
        where
        \[
            T(x)=\begin{cases}
                2x & \text{for }0\leq x\leq\frac{1}{2}, \\
                2(1-x) & \text{for }\frac{1}{2}<x<1.
            \end{cases}
        \]
        There are two equilibrium points, $0$ and $\frac{2}{3}$ (see Figure 1.3). The search or eventually equilibrium points is not as simple algebraically. If $x(0)=\frac{1}{4}$, then $x(1)=\frac{1}{2}$, $x(2)=1$, and $x(3)=0$. Thus $\frac{1}{4}$ is an eventually equilibrium point.
\begin{figure}[H]
    \centering
    \incfig{tent_map}
    \caption{Equilibrium points of the tent map.}
\end{figure}
\end{eg}

One of the main objectives in the study of a dynamical system is to analyze the behavior of its solutions near an equilibrium point. This study constitutes the stability theory.

\begin{definition}
    (a) The equilibrium point $x^*$ of $x(n+1)=f(x(n))$ is \textit{stable} if given $\varepsilon>0$ there exists $\delta>0$ such that $|x_0-x^*|<\delta$ implies $|f^n(x_0)-x^*|<\varepsilon$ for all $n>0$. If $x^*$ is not stable, then it is called \textit{unstable}.

    (b) The point $x^*$ is said to be \textit{attracting} if there exists $\eta>0$ such that
    \[|x(0)-x^*|<\eta\text{ implies }\lim_{n\to\infty} x(n)=x^*.\]
    If $\eta=\infty$, $x^*$ is called a \textit{global attractor} or \textit{globally attracting}
    
    (c) The point $x^*$ is an \textit{asymptotically stable equilibrium point} if it is stable and attracting.

    If $\eta=\infty$, $x^*$ is said to be \textit{globally asymptotically stable}.
\end{definition}

\subsection{The Stair Step (Cobweb) Diagrams}

Another important graphical method for analyzing the stability of equilibrium (and periodic) points for $x(n+1)=f(x(n))$: We may draw a graph of $f$ in the plane $(x(n),x(n+1))$. Given $x(0)=x_0$, we pinpoint the value $x(1)$ by drawing a vertical line through $x(0)$ so that it alse intersects the graph of $f$ at $(x(0),x(1))$. Next, draw a horizontal line from $(x(0),x(1))$ to meet the diagonal line $y=x$ at point $(x(1),x(1))$. A vertical line drawn from the point $(x(1),x(1))$ will meet the graph of $f$ at the point $(x(1),x(2))$. Continuing this process, one may find $x(n)$ for all $n>0$.

\begin{eg}[The logistic Equation]
    Let $y(n)$ be the size of a population at time $n$. If $\mu$ is the rate of growth of the population from one generation to another, then we may consider a mathematical model in the form
    \[
        y(n+1)=\mu y(n),\quad\mu>0.
    \]
    If the initial population is given by $y(0)=y_0$, then by simple iteration we find that
    \[
        y(n)=\mu^n y_0
    \]
    is the solution. If $\mu>1$, then $y(n)$ increases indefinitely, and $\lim_{n\to\infty}y(n)=\infty$. If $\mu=1$, then $y(n)=y_0$ for all $n>0$, which means that the size of the population is constant for the indefinite future. However, for $\mu<1$, we have $\lim_{n\to\infty}y(n)=0$, and the population eventually becomes extinct.

    For most biological species, however, none of the above cases is valid as the population increases until it reaches a certain upper limit. Then, due to the limitations of available resources, the creatures will become testy and engage in competition for those limited resources. This competition is proportional to the number of squabbles among them, given by $by^2(n)$ which has a proportionality constant $b>0$,
    \[
        y(n+1)=\mu y(n)-by^2(n).
    \]
    Let $x(n)=\frac{b}{\mu}y(n)$, we obtain
    \[
        x(n+1)=\mu x(n)(1-x(n))=f(x(n))
    \]
    This equation is the simplest nonlinear first-order difference equation, commonly referred to as the (discrete) logistic equation. However, a closed-form solution is not available (except for certain values of $\mu$). In spite of its simplicity, this equation exhibits rather rich and complicated dynamics. To find the equilibrium we let $f(x^*)=\mu x^*(1-x^*)=x^*$. Thus, we pinpoint two equilibrium points: $x^*=0$ and $x^*=(\mu-1)/\mu$.
    Figure 1.4 gives the stair step diagram of $(x(n),x(n+1))$ when $\mu=2.5$ and $x(0)=0.1$. In this case we also have two equilibrium points. One, $x^*=0$, is unstable, and the other $x^*=0.6$, is asymptotically stable.
\begin{figure}[H]
    \centering
    \incfig{stair_step_diagram}
    \caption{Stair step diagram for $\mu=2.5$.}
\end{figure}
\end{eg}

\begin{eg}[The Cobweb Phenomenon (Economics Application)]
Here we study the pricing of a certain commodity. Let $S(n)$ be the number of units supplied in period $n$, $D(n)$ the number of units demanded in period $n$, and $p(n)$ the price per unit in period $n$.

For simplicity, we assume that $D(n)$ depends only linearly on $p(n)$ and is denoted by
\[
    D(n)=-m_d p(n)+b_d,\quad m_d>0, b_d>0.
\]
This equation is referred to as the price-demand curve. The constant $m_d$ represents the sensitivity of consumers to price. We also assume that the price-supply curve relates the supply in any period to the price one period before, i.e.,
\[
    S(n+1)=m_s p(n)+b_s,\quad m_s>0, b_s>0.
\]
The constant $m_s$ is the sensitivity of suppliers to price. The slope of the demand curve is negative because an increase of one unit in price produces a decrease of $m_d$ units in demand. Correspondingly, an increase of one unit in price causes an increase of $m_s$ units in supply, creating a positive slope for that curve.

A third assumption we make here is that the market price is the price at which the quantity demanded and the quantity supplied are equal, that is, at which $D(n+1)=S(n+1)$.

Thus
\[
    -m_d p(n+1)+b_d=m_s p(n)+b_s,
\]
or
\[
    p(n+1)=Ap(n)+B=f(p(n)),
\]
where $A=-m_s/m_d$, $B=(b_d-b_s)/m_d$. This equation is a first-order linear difference equation. The equilibrium price $p^*$ is defined in economics as the price that results in an intersection of the supply $S(n+1)$ and demand $D(n)$ curves. Also, since $p^*$ is the unique fixed point of $f(p)$, $p^*=B/(1-A)$. Because $A$ is the ratio of the slopes of the supply and demand curves, this ratio determines the behavior of the price sequence. There are three cases to be considered: \\
(a) $-1<A<0$, \\
(b) $A=-1$, \\
(c) $A<-1$. \\
The three cases are now depicted graphically using our old standby, the stair step diagram.
\begin{figure}[H]
    \centering
    \incfig{cobweb_phenomenon_1}
    \caption{Asymptotically stable equilibrium price.}
\end{figure}
\begin{figure}[H]
    \centering
    \incfig{cobweb_phenomenon_2}
    \caption{Stable equilibrium price.}
\end{figure}
\end{eg}
